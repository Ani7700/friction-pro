"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[793],{5003:function(e,n,a){a.d(n,{B_:function(){return b},E9:function(){return c},GL:function(){return i},I9:function(){return h},Pw:function(){return o},Q7:function(){return r},X3:function(){return f},be:function(){return d},c:function(){return u},fp:function(){return s},we:function(){return m}});var t=a(2020),l=a(5249);let r=(0,t.Ue)()((0,l.tJ)(e=>({API:"",setAPI:n=>e({API:n})}),{name:"openai-api",skipHydration:!0})),o=(0,t.Ue)()((0,l.tJ)(e=>({fileSuffix:"p0_2",setFileSuffix:n=>e({fileSuffix:n})}),{name:"file-suffix",skipHydration:!1})),i=(0,t.Ue)()((0,l.tJ)(e=>({essay:[],setEssay:n=>e({essay:n}),replaceSentenceContentById:(n,a)=>e(e=>{let t=e.essay.find(e=>e.id===n);return t&&(t.content=a),{essay:e.essay}})}),{name:"essay",skipHydration:!0})),u=(0,t.Ue)()((0,l.tJ)((e,n)=>({feedback:[],setFeedback:n=>e({feedback:n}),setAddressed:(n,a)=>e(e=>({feedback:e.feedback.map(e=>e.id===n?{...e,addressed:a}:e)})),getFeedbackById:e=>n().feedback.find(n=>n.id===e),getGPTPlanById:e=>{let a=n().feedback.findIndex(n=>n.id===e);if(-1!==a)return n().feedback[a].plan},getFeedbackBySentenceId:e=>n().feedback.filter(n=>{var a;return null===(a=n.plan)||void 0===a?void 0:a.some(n=>n.what.includes(e))}),getGPTPlanByIdAndSentence:(e,a)=>{let t=n().feedback.find(n=>n.id===e);return null==t?void 0:t.plan.find(e=>e.sentence===a)}}),{name:"feedback",skipHydration:!0}));(0,t.Ue)()((0,l.tJ)(e=>({feedback_source:[],setFeedbackSource:n=>e({feedback_source:n})}),{name:"feedback_source",skipHydration:!1}));let d=(0,t.Ue)()((0,l.tJ)((e,n)=>({claim:{},reasoning:{},evidence:{},rebuttal:{},others:{},orthography:{},organization:{},"word-usage":{},setFeedbackCategoryDistributionByCategory:(n,a)=>e(e=>({...e,[n]:a})),getFeedbackCategoryDistributionByCategory:e=>n()[e],decreaseOneByFeedbackCategoryAndSentenceID:(n,a)=>e(e=>{let t=e[n];return t[a.toString()]>0&&(t[a.toString()]-=1),{...e,[n]:t}})}),{name:"feedback_category_distribution",skipHydration:!1})),c=(0,t.Ue)()((0,l.tJ)((e,n)=>({humanPlan:[],addHumanPlan:n=>{e(e=>(e.humanPlan.push(n),{humanPlan:e.humanPlan}))},addSentenceToHumanPlan:(n,a,t)=>e(e=>{let l=e.humanPlan.findIndex(e=>e.feedbackId===n);if(-1!==l){if(e.humanPlan[l].plan.find(e=>e.sentence===a))return{humanPlan:e.humanPlan};e.humanPlan[l].plan.push({sentence:a,what:[t],why:null,how:null})}return{humanPlan:e.humanPlan}}),setHumanPlanbyId:(n,a)=>e(e=>{let t=e.humanPlan.findIndex(e=>e.feedbackId===n);return -1!==t?e.humanPlan[t]=a:e.humanPlan.push(a),{humanPlan:e.humanPlan}}),getHumanPlanById:e=>n().humanPlan.find(n=>n.feedbackId===e),removeHumanPlanById:n=>e(e=>(e.humanPlan=e.humanPlan.filter(e=>e.feedbackId!==n),{humanPlan:e.humanPlan})),removeSentenceFromHumanPlan:(n,a)=>e(e=>{let t=e.humanPlan.findIndex(e=>e.feedbackId===n);return -1!==t&&(e.humanPlan[t].plan=e.humanPlan[t].plan.filter(e=>e.sentence!==a)),{humanPlan:e.humanPlan}}),addWhyToHumanPlan:(n,a,t)=>e(e=>{let l=e.humanPlan.findIndex(e=>e.feedbackId===n);if(-1!==l){let n=e.humanPlan[l].plan.findIndex(e=>e.sentence===a);-1!==n&&(e.humanPlan[l].plan[n].why=t)}return{humanPlan:e.humanPlan}}),addHowToHumanPlan:(n,a,t)=>e(e=>{let l=e.humanPlan.findIndex(e=>e.feedbackId===n);if(-1!==l){let n=e.humanPlan[l].plan.findIndex(e=>e.sentence===a);-1!==n&&(e.humanPlan[l].plan[n].how=t)}return{humanPlan:e.humanPlan}}),getDistributionAcrossSentences:()=>{let e=[],n=i.getState().essay.length;c.getState().humanPlan.forEach(n=>{var a;null===(a=n.plan)||void 0===a||a.forEach(n=>{n.what&&e.push(...n.what)})});let a={};e.forEach(e=>{a[e]=(a[e]||0)+1});let t={};for(let e=1;e<=n;e++){var l;t[e]=null!==(l=a[e.toString()])&&void 0!==l?l:0}return t}}),{name:"feedback-plan",skipHydration:!1})),s=(0,t.Ue)()((0,l.tJ)((e,n)=>({revision:[],addRevision:n=>e(e=>(e.revision.push(n),{revision:e.revision})),addRevisionItem:(n,a,t)=>e(e=>{let l=e.revision.findIndex(e=>e.sentence===a);return -1!==l?e.revision[l].revision.push(t):e.revision.push({id:n,sentence:a,revision:[t]}),{revision:e.revision}}),getRevisionBySentence:e=>n().revision.find(n=>n.sentence===e),getRevisionById:e=>n().revision.find(n=>n.id===e),isRevisionBetter:e=>{let a=!1;return n().revision.forEach(n=>{n.revision.forEach(n=>{n.revision===e&&(a=n.better)})}),a}}),{name:"revision",skipHydration:!1})),f=(0,t.Ue)()((0,l.tJ)(e=>({feedbackSummary:"",setFeedbackSummary:n=>e({feedbackSummary:n})}),{name:"feedback-summary",skipHydration:!1})),m=(0,t.Ue)()((0,l.tJ)(e=>({globalSentence:{},setGlobalSentence:n=>e({globalSentence:n})}),{name:"global-sentence",skipHydration:!1})),b=(0,t.Ue)()((0,l.tJ)(e=>({globalFeedback:[],setGlobalFeedback:n=>e({globalFeedback:n})}),{name:"global-feedback",skipHydration:!1})),h=(0,t.Ue)()((0,l.tJ)((e,n)=>({globalHumanPlan:[],initiateOneGlobalHumanPlan:n=>{e(e=>(e.globalHumanPlan.push(n),{globalHumanPlan:e.globalHumanPlan}))},removeReflectionBySentenceIdAndFeedback:(n,a)=>{e(e=>{let t=e.globalHumanPlan.findIndex(e=>e.id===n);return -1!==t&&(e.globalHumanPlan[t].reflection=e.globalHumanPlan[t].reflection.filter(e=>e.feedback!==a)),{globalHumanPlan:e.globalHumanPlan}})},getGlobalHumanPlanBySentenceId:e=>n().globalHumanPlan.find(n=>n.id===e),addWhyToGlobalHumanPlanBySentenceIdAndFeedback:(n,a,t)=>e(e=>{if(void 0===a)return{globalHumanPlan:e.globalHumanPlan};let l=e.globalHumanPlan.findIndex(e=>e.id===n);if(-1!==l){let n=e.globalHumanPlan[l].reflection.findIndex(e=>e.feedback===a);-1!==n&&(e.globalHumanPlan[l].reflection[n].why=t)}return{globalHumanPlan:e.globalHumanPlan}}),addHowToGlobalHumanPlanBySentenceIdAndFeedback:(a,t,l)=>e(e=>{let r=n().ifSinglePlanCompletedBySentenceIdAndFeedback(a,t||"");if(void 0===t)return{globalHumanPlan:e.globalHumanPlan};let o=e.globalHumanPlan.findIndex(e=>e.id===a);if(-1!==o){let n=e.globalHumanPlan[o].reflection.findIndex(e=>e.feedback===t);-1!==n&&(e.globalHumanPlan[o].reflection[n].how=l)}if(!r){let e=u.getState().feedback.find(e=>e.content===t);if(e){let n=e.type.toLowerCase().replace(/\s+/g,"-");d.getState().decreaseOneByFeedbackCategoryAndSentenceID(n,a)}}return{globalHumanPlan:e.globalHumanPlan}}),ifSinglePlanCompletedBySentenceIdAndFeedback:(e,a)=>{let t=n().globalHumanPlan.find(n=>n.id===e);if(t){let e=t.reflection.find(e=>e.feedback===a);if(e)return""!==e.why&&""!==e.how}return!1}}),{name:"global-feedback-plan",skipHydration:!1}))},9793:function(e,n,a){a.d(n,{Cq:function(){return g},YV:function(){return h},cn:function(){return f},H8:function(){return m},xT:function(){return s},wy:function(){return P},Lb:function(){return p},vU:function(){return b}});var t=a(3167),l=a(1367),r=a(2968),o=a(1748),i=a(6142);a(3493);let u=(0,i.ZF)({apiKey:"AIzaSyDbGigDei6QdP64YSmEj89KAAaJgSjQYfA",authDomain:"friction-b30c6.firebaseapp.com",databaseURL:"https://friction-b30c6-default-rtdb.europe-west1.firebasedatabase.app",projectId:"friction-b30c6",storageBucket:"friction-b30c6.firebasestorage.app",messagingSenderId:"402376957247",appId:"1:402376957247:web:222777476a93bf5451878a",measurementId:"G-ZYF0Z5Q5TB"}),d=(0,o.N8)(u);var c=a(5003);function s(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.Pw.getState().fileSuffix;try{let a=(0,o.iH)(d,"events/"+n),t={};t="string"==typeof e?{event:e,timestamp:Date.now()}:{...e,timestamp:Date.now()},(0,o.VF)(a,t)}catch(n){console.log("event:",e),console.error("Error tracking event:",n)}}function f(){for(var e=arguments.length,n=Array(e),a=0;a<e;a++)n[a]=arguments[a];return(0,l.m6)((0,t.W)(n))}function m(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"essay-revised.txt",a=function(e){if(0===e.length)return"";let n=new Map;for(let t of e){var a;let e=null!==(a=t.paragraph)&&void 0!==a?a:1;n.has(e)||n.set(e,[]),n.get(e).push(t.content.trim())}return Array.from(n.entries()).sort((e,n)=>e[0]-n[0]).map(e=>{let[,n]=e;return n.join(" ")}).join("\n\n")}(e),t=new Blob([a],{type:"text/plain;charset=utf-8"}),l=URL.createObjectURL(t),r=document.createElement("a");r.href=l,r.download=n,r.click(),URL.revokeObjectURL(l)}function b(e,n){let a=e.toLowerCase().split(/\W+/).filter(Boolean);return n.some(e=>{let n=e.toLowerCase().split(/\W+/).filter(Boolean);return a.filter(e=>n.includes(e)).length/Math.max(a.length,n.length)>=.65})}let h={Claim:"#ec4899",Reasoning:"#ef4444",Evidence:"#f97316",Rebuttal:"#f59e0b",Others:"#78716c",Organization:"#8b5cf6","Word-usage":"#06b6d4","Word Usage":"#06b6d4",Orthography:"#3b82f6"},g={Default:"#F3F4F6",Prompt:"#1F2937",What:"#0284C7",Why:"#DC2626",How:"#EA580C",Revision:"#059669",Summary:"#4b5563"},p=async function(e,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.7,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:256,l=c.Q7.getState().API,o=new r.ZP({apiKey:l,dangerouslyAllowBrowser:!0});try{return(await o.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:e},{role:"user",content:n}],temperature:a,max_tokens:t,top_p:1,frequency_penalty:0,presence_penalty:0})).choices[0].message.content}catch(e){console.error("Error fetching AI response:",e),e.message.includes("Incorrect API key provided")&&alert("Error fetching AI response: Incorrect API key provided. You can find your API key at https://platform.openai.com/account/api-keys.")}},P=async(e,n)=>{let a=c.Q7.getState().API,t=new r.ZP({apiKey:a,dangerouslyAllowBrowser:!0});try{let a=await t.chat.completions.create({model:"ft:gpt-3.5-turbo-0613:jeff-rz-cornell-university::8ru54eYb",messages:[{role:"system",content:"Given the original sentence, determine whether the revision made the original sentence better or not."},{role:"user",content:"original sentence: "+e+"\nrevision: "+n+"\nbetter (Yes/No): "}],temperature:0,max_tokens:256,top_p:1,frequency_penalty:0,presence_penalty:0});return console.log(a.choices[0].message.content),a.choices[0].message.content}catch(e){console.error("Error fetching AI response:",e)}}}}]);