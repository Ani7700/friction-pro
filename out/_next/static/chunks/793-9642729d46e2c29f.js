"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[793],{5003:function(e,n,a){a.d(n,{B_:function(){return b},E9:function(){return c},GL:function(){return o},I9:function(){return g},Pw:function(){return i},Q7:function(){return l},X3:function(){return f},be:function(){return u},c:function(){return d},fp:function(){return s},we:function(){return m}});var t=a(2020),r=a(5249);let l=(0,t.Ue)()((0,r.tJ)(e=>({API:"",setAPI:n=>e({API:n})}),{name:"openai-api",skipHydration:!0})),i=(0,t.Ue)()((0,r.tJ)(e=>({fileSuffix:"",setFileSuffix:n=>e({fileSuffix:n})}),{name:"file-suffix",skipHydration:!1})),o=(0,t.Ue)()((0,r.tJ)(e=>({essay:[],setEssay:n=>e({essay:n}),replaceSentenceContentById:(n,a)=>e(e=>{let t=e.essay.find(e=>e.id===n);return t&&(t.content=a),{essay:e.essay}})}),{name:"essay",skipHydration:!1})),d=(0,t.Ue)()((0,r.tJ)((e,n)=>({feedback:[],setFeedback:n=>e({feedback:n}),setAddressed:(n,a)=>e(e=>({feedback:e.feedback.map(e=>e.id===n?{...e,addressed:a}:e)})),getFeedbackById:e=>n().feedback.find(n=>n.id===e),getGPTPlanById:e=>{let a=n().feedback.findIndex(n=>n.id===e);if(-1!==a)return n().feedback[a].plan},getFeedbackBySentenceId:e=>n().feedback.filter(n=>{var a;return null===(a=n.plan)||void 0===a?void 0:a.some(n=>n.what.includes(e))}),getGPTPlanByIdAndSentence:(e,a)=>{let t=n().feedback.find(n=>n.id===e);return null==t?void 0:t.plan.find(e=>e.sentence===a)}}),{name:"feedback",skipHydration:!1}));(0,t.Ue)()((0,r.tJ)(e=>({feedback_source:[],setFeedbackSource:n=>e({feedback_source:n})}),{name:"feedback_source",skipHydration:!1}));let u=(0,t.Ue)()((0,r.tJ)((e,n)=>({claim:{},reasoning:{},evidence:{},rebuttal:{},others:{},orthography:{},organization:{},"word-usage":{},setFeedbackCategoryDistributionByCategory:(n,a)=>e(e=>({...e,[n]:a})),getFeedbackCategoryDistributionByCategory:e=>n()[e],decreaseOneByFeedbackCategoryAndSentenceID:(n,a)=>e(e=>{let t=e[n];return t[a.toString()]>0&&(t[a.toString()]-=1),{...e,[n]:t}})}),{name:"feedback_category_distribution",skipHydration:!1})),c=(0,t.Ue)()((0,r.tJ)((e,n)=>({humanPlan:[],addHumanPlan:n=>{e(e=>(e.humanPlan.push(n),{humanPlan:e.humanPlan}))},addSentenceToHumanPlan:(n,a,t)=>e(e=>{let r=e.humanPlan.findIndex(e=>e.feedbackId===n);if(-1!==r){if(e.humanPlan[r].plan.find(e=>e.sentence===a))return{humanPlan:e.humanPlan};e.humanPlan[r].plan.push({sentence:a,what:[t],why:null,how:null})}return{humanPlan:e.humanPlan}}),setHumanPlanbyId:(n,a)=>e(e=>{let t=e.humanPlan.findIndex(e=>e.feedbackId===n);return -1!==t?e.humanPlan[t]=a:e.humanPlan.push(a),{humanPlan:e.humanPlan}}),getHumanPlanById:e=>n().humanPlan.find(n=>n.feedbackId===e),removeHumanPlanById:n=>e(e=>(e.humanPlan=e.humanPlan.filter(e=>e.feedbackId!==n),{humanPlan:e.humanPlan})),removeSentenceFromHumanPlan:(n,a)=>e(e=>{let t=e.humanPlan.findIndex(e=>e.feedbackId===n);return -1!==t&&(e.humanPlan[t].plan=e.humanPlan[t].plan.filter(e=>e.sentence!==a)),{humanPlan:e.humanPlan}}),addWhyToHumanPlan:(n,a,t)=>e(e=>{let r=e.humanPlan.findIndex(e=>e.feedbackId===n);if(-1!==r){let n=e.humanPlan[r].plan.findIndex(e=>e.sentence===a);-1!==n&&(e.humanPlan[r].plan[n].why=t)}return{humanPlan:e.humanPlan}}),addHowToHumanPlan:(n,a,t)=>e(e=>{let r=e.humanPlan.findIndex(e=>e.feedbackId===n);if(-1!==r){let n=e.humanPlan[r].plan.findIndex(e=>e.sentence===a);-1!==n&&(e.humanPlan[r].plan[n].how=t)}return{humanPlan:e.humanPlan}}),getDistributionAcrossSentences:()=>{let e=[],n=o.getState().essay.length;c.getState().humanPlan.forEach(n=>{var a;null===(a=n.plan)||void 0===a||a.forEach(n=>{n.what&&e.push(...n.what)})});let a={};e.forEach(e=>{a[e]=(a[e]||0)+1});let t={};for(let e=1;e<=n;e++){var r;t[e]=null!==(r=a[e.toString()])&&void 0!==r?r:0}return t}}),{name:"feedback-plan",skipHydration:!1})),s=(0,t.Ue)()((0,r.tJ)((e,n)=>({revision:[],addRevision:n=>e(e=>(e.revision.push(n),{revision:e.revision})),addRevisionItem:(n,a,t)=>e(e=>{let r=e.revision.findIndex(e=>e.sentence===a);return -1!==r?e.revision[r].revision.push(t):e.revision.push({id:n,sentence:a,revision:[t]}),{revision:e.revision}}),getRevisionBySentence:e=>n().revision.find(n=>n.sentence===e),getRevisionById:e=>n().revision.find(n=>n.id===e),isRevisionBetter:e=>{let a=!1;return n().revision.forEach(n=>{n.revision.forEach(n=>{n.revision===e&&(a=n.better)})}),a}}),{name:"revision",skipHydration:!1})),f=(0,t.Ue)()((0,r.tJ)(e=>({feedbackSummary:"",setFeedbackSummary:n=>e({feedbackSummary:n})}),{name:"feedback-summary",skipHydration:!1})),m=(0,t.Ue)()((0,r.tJ)(e=>({globalSentence:{},setGlobalSentence:n=>e({globalSentence:n})}),{name:"global-sentence",skipHydration:!1})),b=(0,t.Ue)()((0,r.tJ)(e=>({globalFeedback:[],setGlobalFeedback:n=>e({globalFeedback:n})}),{name:"global-feedback",skipHydration:!1})),g=(0,t.Ue)()((0,r.tJ)((e,n)=>({globalHumanPlan:[],initiateOneGlobalHumanPlan:n=>{e(e=>(e.globalHumanPlan.push(n),{globalHumanPlan:e.globalHumanPlan}))},removeReflectionBySentenceIdAndFeedback:(n,a)=>{e(e=>{let t=e.globalHumanPlan.findIndex(e=>e.id===n);return -1!==t&&(e.globalHumanPlan[t].reflection=e.globalHumanPlan[t].reflection.filter(e=>e.feedback!==a)),{globalHumanPlan:e.globalHumanPlan}})},getGlobalHumanPlanBySentenceId:e=>n().globalHumanPlan.find(n=>n.id===e),addWhyToGlobalHumanPlanBySentenceIdAndFeedback:(n,a,t)=>e(e=>{if(void 0===a)return{globalHumanPlan:e.globalHumanPlan};let r=e.globalHumanPlan.findIndex(e=>e.id===n);if(-1!==r){let n=e.globalHumanPlan[r].reflection.findIndex(e=>e.feedback===a);-1!==n&&(e.globalHumanPlan[r].reflection[n].why=t)}return{globalHumanPlan:e.globalHumanPlan}}),addHowToGlobalHumanPlanBySentenceIdAndFeedback:(a,t,r)=>e(e=>{let l=n().ifSinglePlanCompletedBySentenceIdAndFeedback(a,t||"");if(void 0===t)return{globalHumanPlan:e.globalHumanPlan};let i=e.globalHumanPlan.findIndex(e=>e.id===a);if(-1!==i){let n=e.globalHumanPlan[i].reflection.findIndex(e=>e.feedback===t);-1!==n&&(e.globalHumanPlan[i].reflection[n].how=r)}if(!l){let e=d.getState().feedback.find(e=>e.content===t);if(e){let n=e.type.toLowerCase().replace(/\s+/g,"-");u.getState().decreaseOneByFeedbackCategoryAndSentenceID(n,a)}}return{globalHumanPlan:e.globalHumanPlan}}),ifSinglePlanCompletedBySentenceIdAndFeedback:(e,a)=>{let t=n().globalHumanPlan.find(n=>n.id===e);if(t){let e=t.reflection.find(e=>e.feedback===a);if(e)return""!==e.why&&""!==e.how}return!1}}),{name:"global-feedback-plan",skipHydration:!1}))},9793:function(e,n,a){a.d(n,{Cq:function(){return h},YV:function(){return g},cn:function(){return f},H8:function(){return m},xT:function(){return s},wy:function(){return y},Lb:function(){return p},vU:function(){return b}});var t=a(3167),r=a(1367),l=a(2968),i=a(1748),o=a(6142);a(3493);let d=(0,o.ZF)({apiKey:"AIzaSyDbGigDei6QdP64YSmEj89KAAaJgSjQYfA",authDomain:"friction-b30c6.firebaseapp.com",databaseURL:"https://friction-b30c6-default-rtdb.europe-west1.firebasedatabase.app",projectId:"friction-b30c6",storageBucket:"friction-b30c6.firebasestorage.app",messagingSenderId:"402376957247",appId:"1:402376957247:web:222777476a93bf5451878a",measurementId:"G-ZYF0Z5Q5TB"}),u=(0,i.N8)(d);var c=a(5003);function s(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.Pw.getState().fileSuffix;try{if(!(null==n?void 0:n.trim()))return;let a=(0,i.iH)(u,"events/"+n),t={};t="string"==typeof e?{event:e,timestamp:Date.now()}:{...e,timestamp:Date.now()},(0,i.VF)(a,t)}catch(n){console.log("event:",e),console.error("Error tracking event:",n)}}function f(){for(var e=arguments.length,n=Array(e),a=0;a<e;a++)n[a]=arguments[a];return(0,r.m6)((0,t.W)(n))}function m(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"essay-revised.txt",a=function(e){if(0===e.length)return"";let n=new Map;for(let t of e){var a;let e=null!==(a=t.paragraph)&&void 0!==a?a:1;n.has(e)||n.set(e,[]),n.get(e).push(t.content.trim())}return Array.from(n.entries()).sort((e,n)=>e[0]-n[0]).map(e=>{let[,n]=e;return n.join(" ")}).join("\n\n")}(e),t=new Blob([a],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(t),l=document.createElement("a");l.href=r,l.download=n,l.click(),URL.revokeObjectURL(r)}function b(e,n){let a=e.toLowerCase().split(/\W+/).filter(Boolean);return n.some(e=>{let n=e.toLowerCase().split(/\W+/).filter(Boolean);return a.filter(e=>n.includes(e)).length/Math.max(a.length,n.length)>=.65})}let g={Claim:"#ec4899",Reasoning:"#ef4444",Evidence:"#f97316",Rebuttal:"#f59e0b",Others:"#78716c",Organization:"#8b5cf6","Word-usage":"#06b6d4","Word Usage":"#06b6d4",Orthography:"#3b82f6"},h={Default:"#F3F4F6",Prompt:"#1F2937",What:"#0284C7",Why:"#DC2626",How:"#EA580C",Revision:"#059669",Summary:"#4b5563"},p=async function(e,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.7,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:256,r=c.Q7.getState().API,i=new l.ZP({apiKey:r,dangerouslyAllowBrowser:!0});try{return(await i.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:e},{role:"user",content:n}],temperature:a,max_tokens:t,top_p:1,frequency_penalty:0,presence_penalty:0})).choices[0].message.content}catch(n){var o;console.error("Error fetching AI response:",n);let e=null!==(o=null==n?void 0:n.message)&&void 0!==o?o:String(n);if(e.includes("Incorrect API key")||e.includes("Invalid API key"))throw Error("Invalid OpenAI API key. Please check and try again. Find your key at https://platform.openai.com/account/api-keys");if(e.includes("rate limit")||e.includes("Rate limit"))throw Error("Rate limit exceeded. Please try again later.");if(e.includes("network")||(null==n?void 0:n.name)==="TypeError")throw Error("Network error. Please check your connection and try again.");throw Error(e||"Something went wrong while generating feedback. Please try again.")}},y=async(e,n)=>{let a=c.Q7.getState().API,t=new l.ZP({apiKey:a,dangerouslyAllowBrowser:!0});try{let a=await t.chat.completions.create({model:"ft:gpt-3.5-turbo-0613:jeff-rz-cornell-university::8ru54eYb",messages:[{role:"system",content:"Given the original sentence, determine whether the revision made the original sentence better or not."},{role:"user",content:"original sentence: "+e+"\nrevision: "+n+"\nbetter (Yes/No): "}],temperature:0,max_tokens:256,top_p:1,frequency_penalty:0,presence_penalty:0});return console.log(a.choices[0].message.content),a.choices[0].message.content}catch(e){console.error("Error fetching AI response:",e)}}}}]);