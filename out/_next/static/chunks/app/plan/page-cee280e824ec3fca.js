(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[927],{6051:function(e,l,t){Promise.resolve().then(t.bind(t,7679))},7679:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return x}});var a=t(3827),s=t(4090),n=t(1150),i=t(5003),d=t(9793),r=t(6924),o=t(8191),c=t(8792),h=t(102);let g=e=>{let l=(0,i.we)(e=>e.globalSentence);return(0,a.jsxs)("div",{className:"flex flex-row w-full justify-between items-center",children:[(0,a.jsxs)("h1",{className:"text-2xl font-semibold text-gray-400",children:["Step ",e.planStage,"/3",(0,a.jsx)("span",{className:"text-gray-800",children:1===e.planStage?" - Cluster":2===e.planStage?" - Diagnose":" - Strategize"})]}),(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[1===e.planStage?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(r.zx,{color:"light",className:"w-40 enabled:hover:ring-gray-800 enabled:ring-gray-800 hover:ring-gray-800",onClick:()=>{e.setPlanStage(e.planStage+1),(0,d.xT)({event:"forward_to_diagnose",sentence:0===Object.keys(l).length?"all":l.id})},children:[(0,a.jsx)(h.WmH,{size:20,className:"mr-2 h-5 w-5"}),"Next Step"]})}):null,2===e.planStage?(0,a.jsxs)(a.Fragment,{children:[" ",(0,a.jsxs)(r.zx,{color:"light",className:"w-40 enabled:hover:ring-gray-800 enabled:ring-gray-800 hover:ring-gray-800",onClick:()=>{e.setPlanStage(e.planStage-1),(0,d.xT)({event:"backward_to_cluster",sentence:0===Object.keys(l).length?"all":l.id})},children:[(0,a.jsx)(h.io$,{size:20,className:"mr-2 h-5 w-5"}),"Previous Step"]}),(0,a.jsxs)(r.zx,{color:"light",className:"w-40 enabled:hover:ring-gray-800 enabled:ring-gray-800 hover:ring-gray-800",onClick:()=>{e.setPlanStage(e.planStage+1),(0,d.xT)({event:"forward_to_strategize",sentence:0===Object.keys(l).length?"all":l.id})},children:[(0,a.jsx)(h.WmH,{size:20,className:"mr-2 h-5 w-5"}),"Next Step"]})]}):null,3===e.planStage?(0,a.jsxs)(a.Fragment,{children:[" ",(0,a.jsxs)(r.zx,{color:"light",className:"w-40 enabled:hover:ring-gray-800 enabled:ring-gray-800 hover:ring-gray-800",onClick:()=>{e.setPlanStage(e.planStage-1),(0,d.xT)({event:"backward_to_diagnose",sentence:0===Object.keys(l).length?"all":l.id})},children:[(0,a.jsx)(h.io$,{size:20,className:"mr-2 h-5 w-5"}),"Previous Step"]})]}):null]})]})},f=e=>(0,a.jsx)("div",{className:"w-full border-l-8 rounded-lg flex flex-col gap-2 p-4 bg-white border-gray-800",children:1===e.planStage?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,a.jsx)(h.VBL,{size:20}),(0,a.jsx)("h1",{className:"font-semibold",children:"Cluster Relevant Feedback"})]}),(0,a.jsx)("p",{className:"text-sm",children:"Group relevant feedback items together to identify common problems and devise a solution to address them"})]}):2===e.planStage?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,a.jsx)(h.VBL,{size:20}),(0,a.jsx)("h1",{className:"font-semibold",children:"Diagnose Specific Problems"})]}),(0,a.jsx)("p",{className:"text-sm",children:"Reflect on each feedback cluster to diagnose the specific problem within this sentence"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,a.jsx)(h.VBL,{size:20}),(0,a.jsx)("h1",{className:"font-semibold",children:"Propose Revision Strategies"})]}),(0,a.jsx)("p",{className:"text-sm",children:"Reflect on each feedback cluster to devise a strategy that can address the diagnosed problem"})]})});var x=()=>{let e=(0,i.we)(e=>e.globalSentence),l=(0,i.B_)(e=>e.globalFeedback);(0,i.I9)(e=>e.globalHumanPlan);let[t,x]=(0,s.useState)([]);(0,s.useMemo)(()=>{x(l.map((e,l)=>({id:l,feedback:[e.id]})))},[]);let[m,u]=(0,s.useState)({}),b=(e,l)=>{u({id:e,initialGroup:l})},v=e=>{e.preventDefault()},p=(l,a)=>{let s=m.id,n=m.initialGroup;if(n.id===a.id)return;let i=t.map(l=>l.id===n.id?{id:l.id,feedback:l.feedback.filter(e=>e!==s)}:l.id===a.id?((0,d.xT)({event:"cluster_feedback",sentence:0===Object.keys(e).length?"all":e.id,feedback:[...l.feedback,s]}),{id:l.id,feedback:[...l.feedback,s]}):l);x(i),console.log("group",a),console.log("newFeedbackGroup",i)},w=(0,i.I9)(e=>e.getGlobalHumanPlanBySentenceId),[j,y]=(0,s.useState)(void 0),[k,N]=(0,s.useState)(1),[S,I]=(0,s.useState)([]);return(0,s.useEffect)(()=>{2===k&&(async()=>{I((await Promise.all(t.map(async e=>{if(!(e.feedback.length>1))return null;{let t=e.feedback.map(e=>{let t=l.find(l=>l.id===e);return(null==t?void 0:t.content)||""}).join("\n"),a=await (0,d.Lb)("Summarize the following feedbacks in 30 words:",t);return{id:e.id,summary:a}}}))).filter(e=>null!==e)),console.log("clusterSummary",S)})()},[k,t,l]),(0,s.useEffect)(()=>{y(w(e.id)),(0,d.xT)({event:"view_plan_page",sentence:0===Object.keys(e).length?"all":e.id})},[e]),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex flex-col h-screen w-full py-4 px-8 bg-gray-50 text-gray-800",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(g,{feedbackId:1,planStage:k,setPlanStage:N}),(0,a.jsx)(f,{planStage:k}),(0,a.jsx)(o.g,{title:"What",id:"what",content:e.content}),(0,a.jsx)("div",{className:"border-t border-dashed border-gray-200 w-full my-2"})]}),(0,a.jsxs)("div",{className:"overflow-y-auto grow py-2",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2 mx-2",children:[" ",t.map((e,t)=>e.feedback.length>0?(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[k>1&&S&&S.filter(l=>l.id===e.id).map((e,l)=>(0,a.jsxs)("div",{className:"w-full border-2 p-4 bg-white rounded-lg text-sm",children:[(0,a.jsxs)("div",{className:"flex flex-row gap-2 items-center pb-2 font-medium",children:[(0,a.jsx)(h.QcQ,{size:20}),(0,a.jsx)("p",{children:"Cluster Summary"})]}),(0,a.jsx)("span",{className:"text-xs",children:"The essay needs robust evidence and specific examples to support its claims about technology's benefits."})]},l)),(0,a.jsxs)("div",{className:"flex flex-col gap-2",onDragOver:v,onDrop:l=>p(l,e),children:[l&&l.filter(l=>e.feedback.includes(l.id)).map((l,t)=>(0,a.jsx)("div",{children:(0,a.jsx)(n.O,{planStage:k,hideContent:e.feedback.length>1&&k>1,feedbackItem:l,classes:"",close:!1,draggable:1===k,onDragStart:t=>b(l.id,e)})},t)),e.feedback.length>0&&k>1&&(0,a.jsx)(o.g,{feedbackId:e.feedback,title:"Why",id:"why"}),e.feedback.length>0&&k>2&&(0,a.jsx)(o.g,{feedbackId:e.feedback,title:"How",id:"how"}),1===k&&(0,a.jsx)("div",{className:"border-t border-dashed border-gray-200 w-full"}),k>1&&e.feedback.length>0&&(0,a.jsx)("div",{className:"border-t border-dashed border-gray-200 w-full"})]},t)]},t):null)]}),(0,a.jsx)("div",{className:"h-48 w-full"})]})]}),3===k?(0,a.jsx)(c.default,{href:"/revision",onClick:e=>{},children:(0,a.jsx)(r.zx,{color:"dark",className:"z-50 fixed bottom-6 right-8 w-40 cursor-pointer enabled:hover:ring-white enabled:ring-white hover:ring-white transition-all duration-150 hover:scale-105",children:"Go to Revision"})}):null]})}},8191:function(e,l,t){"use strict";t.d(l,{g:function(){return h}});var a=t(3827),s=t(4090),n=t(5003),i=t(102),d=t(9793),r=t(1975);let o=e=>{let[l,t]=(0,s.useState)(!1),[o,c]=(0,s.useState)(0),h=(0,n.we)(e=>e.globalSentence);return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:(0,d.cn)({"bg-rose-500":l,"bg-gray-400":!l},"rounded-md w-6 h-6 items-center justify-center flex cursor-pointer transition-all duration-150 ease-in-out hover:scale-110 hover:-translate-y-[1px] hover:shadow-lg hover:bg-rose-500"),onClick:()=>{if(void 0!==h.id&&void 0!==e.feedbackId){if(l?t(!1):t(!0),void 0!==e.why)(0,d.xT)({event:"check_hint",sentence:0===Object.keys(h).length?"all":h.id,feedbackId:e.feedbackId,stage:"why",content:e.why});else if(void 0!==e.how){if((0,d.xT)({event:"check_hint",sentence:0===Object.keys(h).length?"all":h.id,feedbackId:e.feedbackId,stage:"how",content:e.how[o].strategy}),l)return;c((o+1)%e.how.length)}}},children:[void 0!==e.why?(0,a.jsx)(r._S5,{size:14,className:"text-white"}):null,void 0!==e.how&&e.how.length>0&&!l?(0,a.jsx)(i.SCG,{size:16,className:"text-white"}):null,void 0!==e.how&&e.how.length>0&&l?(0,a.jsx)(i.T8D,{size:16,className:"text-white"}):null]}),l&&(0,a.jsxs)("p",{className:"absolute right-0 bottom-8 z-[10000] w-64 bg-white rounded-lg p-4 text-xs leading-5 shadow-lg flex gap-2 select-text border",children:[(0,a.jsx)("b",{className:"select-none",children:"Tip: "}),e.why,e.how&&e.how.length>0&&e.how[o].strategy]})]})};var c=t(1350);let h=e=>{let[l,t]=(0,s.useState)(""),r=(0,n.we)(e=>e.globalSentence),h=(0,n.B_)(e=>e.globalFeedback),g=(0,s.useMemo)(()=>{var l;return null===(l=e.feedbackId)||void 0===l?void 0:l.map(e=>h.find(l=>l.id===e))},[h]);(0,n.I9)(e=>e.globalHumanPlan);let f=(0,n.I9)(e=>e.getGlobalHumanPlanBySentenceId);(0,s.useEffect)(()=>{if(e.content){t(e.content);return}let l=f(r.id);if(void 0===l)return;let a=null==g?void 0:g.map(e=>l.reflection.find(l=>l.feedback===(null==e?void 0:e.content)))[0];"Why"===e.title?(null==a?void 0:a.why)?t(null==a?void 0:a.why):t(""):"How"===e.title&&((null==a?void 0:a.how)?t(null==a?void 0:a.how):t(""))},[r]);let x=(0,n.c)(e=>e.getGPTPlanByIdAndSentence);(0,s.useMemo)(()=>{var l;return void 0===e.feedbackId||void 0===r.content?[]:null===(l=e.feedbackId)||void 0===l?void 0:l.map(e=>void 0===r.content?null:x(e,r.content))},[e.feedbackId,r.content]);let m=(0,n.I9)(e=>e.addHowToGlobalHumanPlanBySentenceIdAndFeedback),u=(0,n.I9)(e=>e.addWhyToGlobalHumanPlanBySentenceIdAndFeedback);return(0,a.jsxs)("div",{className:"w-full border-l-8 rounded-lg flex flex-row gap-2 p-4 bg-white items-start",style:{borderColor:d.Cq[e.title]},children:[(0,a.jsxs)("div",{className:"flex flex-row gap-2 items-center text-sm py-2",children:["summary"===e.id?(0,a.jsx)(i.QcQ,{size:20}):"revision"===e.id?(0,a.jsx)(i.vPl,{size:20}):(0,a.jsx)(i.RxO,{size:20}),"What"===e.title?(0,a.jsx)("h1",{className:"font-semibold",children:"Sentence"}):"Why"===e.title?(0,a.jsx)("h1",{className:"font-semibold",children:"Problem"}):"How"===e.title?(0,a.jsx)("h1",{className:"font-semibold",children:"Solution"}):"Summary"===e.title?(0,a.jsx)("h1",{className:"font-semibold",children:"Summary"}):"Revision"===e.title?(0,a.jsx)("h1",{className:"font-semibold",children:"Revision"}):null]}),"what"===e.id?(0,a.jsx)("p",{className:"rounded-lg px-3 py-2 text-sm select-none",children:(0,a.jsx)(c.Z,{text:e.content||""})}):e.isNotModifiable?(0,a.jsx)("p",{className:"rounded-lg px-3 py-2 text-sm select-none",children:l}):(0,a.jsxs)("div",{className:"w-full flex flex-row justify-between items-center",children:[(0,a.jsx)("input",{type:"text",className:"rounded-lg border-0 text-sm w-full bg-gray-50 focus:ring-gray-400 mx-3",style:{borderWidth:2===e.planStage&&"Why"===e.title||3===e.planStage&&"How"===e.title?2:0,borderColor:2===e.planStage&&"Why"===e.title||3===e.planStage&&"How"===e.title?"skyblue":"gray"},value:l,onChange:e=>{t(e.target.value)},onBlur:()=>{var t,a;"Why"===e.title&&void 0!==e.feedbackId&&void 0!==g&&void 0!==r.id&&(null===(t=e.feedbackId)||void 0===t||t.forEach(e=>{var t;u(r.id,null===(t=g.find(l=>(null==l?void 0:l.id)===e))||void 0===t?void 0:t.content,l),(0,d.xT)({event:"change_plan",sentence:0===Object.keys(r).length?"all":r.id,feedback:e,stage:"why",content:l})})),"How"===e.title&&void 0!==e.feedbackId&&void 0!==g&&void 0!==r.id&&(null===(a=e.feedbackId)||void 0===a||a.forEach(t=>{var a;m(r.id,null===(a=g.find(e=>(null==e?void 0:e.id)===t))||void 0===a?void 0:a.content,l),(0,d.xT)({event:"change_plan",sentence:0===Object.keys(r).length?"all":r.id,feedback:e.feedbackId,stage:"how",content:l})}))}}),"why"===e.id?(0,a.jsx)(o,{why:'This sentence uses general adjectives like "very" and "many," but doesn\'t specify the extent of the positive impact or which specific aspects are affected.',feedbackId:e.feedbackId}):(0,a.jsx)(o,{how:[{title:"xxx",strategy:"Clarify 'many aspects of our lives' by identifying specific domains or areas where the positive impact of hi-tech devices is most felt."},{title:"xxx",strategy:"Provide concrete examples of how hi-tech devices positively impact different aspects of our lives, such as education, health, or communication."}],feedbackId:e.feedbackId})]})]})}}},function(e){e.O(0,[950,954,481,366,670,501,779,458,792,276,793,150,971,69,744],function(){return e(e.s=6051)}),_N_E=e.O()}]);