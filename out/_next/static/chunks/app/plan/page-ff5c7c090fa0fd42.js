(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[927],{6051:function(e,l,t){Promise.resolve().then(t.bind(t,7679))},7679:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return x}});var n=t(3827),a=t(4090),s=t(1150),i=t(5003),d=t(9793),r=t(6924),o=t(8191),c=t(8792),h=t(102);let g=e=>{let l=(0,i.we)(e=>e.globalSentence);return(0,n.jsxs)("div",{className:"flex flex-row w-full justify-between items-center",children:[(0,n.jsxs)("h1",{className:"text-2xl font-semibold text-gray-400",children:["Step ",e.planStage,"/3",(0,n.jsx)("span",{className:"text-gray-800",children:1===e.planStage?" - Cluster":2===e.planStage?" - Diagnose":" - Strategize"})]}),(0,n.jsxs)("div",{className:"flex flex-row gap-2",children:[1===e.planStage?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(r.zx,{color:"light",className:"w-40 enabled:hover:ring-gray-800 enabled:ring-gray-800 hover:ring-gray-800",onClick:()=>{e.setPlanStage(e.planStage+1),(0,d.xT)({event:"forward_to_diagnose",sentence:0===Object.keys(l).length?"all":l.id})},children:[(0,n.jsx)(h.WmH,{size:20,className:"mr-2 h-5 w-5"}),"Next Step"]})}):null,2===e.planStage?(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsxs)(r.zx,{color:"light",className:"w-40 enabled:hover:ring-gray-800 enabled:ring-gray-800 hover:ring-gray-800",onClick:()=>{e.setPlanStage(e.planStage-1),(0,d.xT)({event:"backward_to_cluster",sentence:0===Object.keys(l).length?"all":l.id})},children:[(0,n.jsx)(h.io$,{size:20,className:"mr-2 h-5 w-5"}),"Previous Step"]}),(0,n.jsxs)(r.zx,{color:"light",className:"w-40 enabled:hover:ring-gray-800 enabled:ring-gray-800 hover:ring-gray-800",onClick:()=>{e.setPlanStage(e.planStage+1),(0,d.xT)({event:"forward_to_strategize",sentence:0===Object.keys(l).length?"all":l.id})},children:[(0,n.jsx)(h.WmH,{size:20,className:"mr-2 h-5 w-5"}),"Next Step"]})]}):null,3===e.planStage?(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsxs)(r.zx,{color:"light",className:"w-40 enabled:hover:ring-gray-800 enabled:ring-gray-800 hover:ring-gray-800",onClick:()=>{e.setPlanStage(e.planStage-1),(0,d.xT)({event:"backward_to_diagnose",sentence:0===Object.keys(l).length?"all":l.id})},children:[(0,n.jsx)(h.io$,{size:20,className:"mr-2 h-5 w-5"}),"Previous Step"]})]}):null]})]})},f=e=>(0,n.jsx)("div",{className:"w-full border-l-8 rounded-lg flex flex-col gap-2 p-4 bg-white border-gray-800",children:1===e.planStage?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,n.jsx)(h.VBL,{size:20}),(0,n.jsx)("h1",{className:"font-semibold",children:"Cluster Relevant Feedback"})]}),(0,n.jsx)("p",{className:"text-sm",children:"Group relevant feedback items together to identify common problems and devise a solution to address them"})]}):2===e.planStage?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,n.jsx)(h.VBL,{size:20}),(0,n.jsx)("h1",{className:"font-semibold",children:"Diagnose Specific Problems"})]}),(0,n.jsx)("p",{className:"text-sm",children:"Reflect on each feedback cluster to diagnose the specific problem within this sentence"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,n.jsx)(h.VBL,{size:20}),(0,n.jsx)("h1",{className:"font-semibold",children:"Propose Revision Strategies"})]}),(0,n.jsx)("p",{className:"text-sm",children:"Reflect on each feedback cluster to devise a strategy that can address the diagnosed problem"})]})});var x=()=>{let e=(0,i.we)(e=>e.globalSentence),l=(0,i.B_)(e=>e.globalFeedback);(0,i.I9)(e=>e.globalHumanPlan);let[t,x]=(0,a.useState)([]);(0,a.useMemo)(()=>{x(l.map((e,l)=>({id:l,feedback:[e.id]})))},[]);let[m,u]=(0,a.useState)({}),b=(e,l)=>{u({id:e,initialGroup:l})},v=e=>{e.preventDefault()},p=(l,n)=>{let a=m.id,s=m.initialGroup;if(s.id===n.id)return;let i=t.map(l=>l.id===s.id?{id:l.id,feedback:l.feedback.filter(e=>e!==a)}:l.id===n.id?((0,d.xT)({event:"cluster_feedback",sentence:0===Object.keys(e).length?"all":e.id,feedback:[...l.feedback,a]}),{id:l.id,feedback:[...l.feedback,a]}):l);x(i),console.log("group",n),console.log("newFeedbackGroup",i)},w=(0,i.I9)(e=>e.getGlobalHumanPlanBySentenceId),[j,y]=(0,a.useState)(void 0),[k,S]=(0,a.useState)(1),[N,I]=(0,a.useState)([]);return(0,a.useEffect)(()=>{2===k&&(async()=>{I((await Promise.all(t.map(async e=>{if(!(e.feedback.length>1))return null;{let t=e.feedback.map(e=>{let t=l.find(l=>l.id===e);return(null==t?void 0:t.content)||""}).join("\n"),n=await (0,d.Lb)("Summarize the following feedbacks in 30 words:",t);return{id:e.id,summary:n}}}))).filter(e=>null!==e)),console.log("clusterSummary",N)})()},[k,t,l]),(0,a.useEffect)(()=>{y(w(e.id)),(0,d.xT)({event:"view_plan_page",sentence:0===Object.keys(e).length?"all":e.id})},[e]),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex flex-col h-screen w-full py-4 px-8 bg-gray-50 text-gray-800",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(g,{feedbackId:1,planStage:k,setPlanStage:S}),(0,n.jsx)(f,{planStage:k}),(0,n.jsx)(o.g,{title:"What",id:"what",content:e.content}),(0,n.jsx)("div",{className:"border-t border-dashed border-gray-200 w-full my-2"})]}),(0,n.jsxs)("div",{className:"overflow-y-auto grow py-2",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2 mx-2",children:[" ",t.map((e,t)=>e.feedback.length>0?(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[k>1&&N&&N.filter(l=>l.id===e.id).map((e,l)=>(0,n.jsxs)("div",{className:"w-full border-2 p-4 bg-white rounded-lg text-sm",children:[(0,n.jsxs)("div",{className:"flex flex-row gap-2 items-center pb-2 font-medium",children:[(0,n.jsx)(h.QcQ,{size:20}),(0,n.jsx)("p",{children:"Cluster Summary"})]}),(0,n.jsx)("span",{className:"text-xs",children:"The essay needs robust evidence and specific examples to support its claims about technology's benefits."})]},l)),(0,n.jsxs)("div",{className:"flex flex-col gap-2",onDragOver:v,onDrop:l=>p(l,e),children:[l&&l.filter(l=>e.feedback.includes(l.id)).map((l,t)=>(0,n.jsx)("div",{children:(0,n.jsx)(s.O,{planStage:k,hideContent:e.feedback.length>1&&k>1,feedbackItem:l,classes:"",close:!1,draggable:1===k,onDragStart:t=>b(l.id,e)})},t)),e.feedback.length>0&&k>1&&(0,n.jsx)(o.g,{feedbackId:e.feedback,title:"Why",id:"why"}),e.feedback.length>0&&k>2&&(0,n.jsx)(o.g,{feedbackId:e.feedback,title:"How",id:"how"}),1===k&&(0,n.jsx)("div",{className:"border-t border-dashed border-gray-200 w-full"}),k>1&&e.feedback.length>0&&(0,n.jsx)("div",{className:"border-t border-dashed border-gray-200 w-full"})]},t)]},t):null)]}),(0,n.jsx)("div",{className:"h-48 w-full"})]})]}),3===k?(0,n.jsx)(c.default,{href:"/revision",onClick:e=>{},children:(0,n.jsx)(r.zx,{color:"dark",className:"z-50 fixed bottom-6 right-8 w-40 cursor-pointer enabled:hover:ring-white enabled:ring-white hover:ring-white transition-all duration-150 hover:scale-105",children:"Go to Revision"})}):null]})}},1350:function(e,l,t){"use strict";t.d(l,{Z:function(){return r}});var n=t(3827),a=t(4090),s=t(2492);let i=/\\\[([\s\S]+?)\\\]|\\\(([\s\S]+?)\\\)|\$\$([\s\S]+?)\$\$|\$([^$\n]+)\$/g,d=/\\section\{([^}]*)\}|\\subsection\{([^}]*)\}/g;function r(e){let{text:l}=e,t=e=>{let l=[],t=0,s=0;for(let o of e.matchAll(d)){var i,r;let d=null!==(i=o.index)&&void 0!==i?i:0,c=d+o[0].length,h=e.slice(t,d);h&&l.push((0,n.jsx)(a.Fragment,{children:h},"plain-txt-".concat(s++)));let g=o[1],f=o[2],x=!!g,m=(null!==(r=null!=g?g:f)&&void 0!==r?r:"").trim();l.push((0,n.jsx)("span",{className:x?"block text-2xl font-semibold my-4":"block text-xl font-semibold my-3",children:m},"plain-sec-".concat(s++))),t=c}let o=e.slice(t);return o&&l.push((0,n.jsx)(a.Fragment,{children:o},"plain-txt-".concat(s++))),l.length>0?l:[e]},r=[],o=0,c=0;for(let e of l.matchAll(i)){var h,g,f,x;let i=null!==(h=e.index)&&void 0!==h?h:0,d=i+e[0].length,m=l.slice(o,i);if(m)for(let e of t(m))r.push((0,n.jsx)(a.Fragment,{children:e},"txt-".concat(c++)));let u=e[1],b=e[2],v=e[3],p=e[4],w=null!==(x=null!==(f=null!==(g=null!=u?u:b)&&void 0!==g?g:v)&&void 0!==f?f:p)&&void 0!==x?x:"",j=!!(null!=u?u:v);r.push((0,n.jsx)("span",{className:j?"block my-1":void 0,dangerouslySetInnerHTML:{__html:s.ZP.renderToString(w,{throwOnError:!1,displayMode:j,strict:"warn"})}},"math-".concat(c++))),o=d}let m=l.slice(o);if(m)for(let e of t(m))r.push((0,n.jsx)(a.Fragment,{children:e},"txt-".concat(c++)));return(0,n.jsx)(n.Fragment,{children:r.length>0?r:l})}},8191:function(e,l,t){"use strict";t.d(l,{g:function(){return h}});var n=t(3827),a=t(4090),s=t(5003),i=t(102),d=t(9793),r=t(1975);let o=e=>{let[l,t]=(0,a.useState)(!1),[o,c]=(0,a.useState)(0),h=(0,s.we)(e=>e.globalSentence);return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("div",{className:(0,d.cn)({"bg-rose-500":l,"bg-gray-400":!l},"rounded-md w-6 h-6 items-center justify-center flex cursor-pointer transition-all duration-150 ease-in-out hover:scale-110 hover:-translate-y-[1px] hover:shadow-lg hover:bg-rose-500"),onClick:()=>{if(void 0!==h.id&&void 0!==e.feedbackId){if(l?t(!1):t(!0),void 0!==e.why)(0,d.xT)({event:"check_hint",sentence:0===Object.keys(h).length?"all":h.id,feedbackId:e.feedbackId,stage:"why",content:e.why});else if(void 0!==e.how){if((0,d.xT)({event:"check_hint",sentence:0===Object.keys(h).length?"all":h.id,feedbackId:e.feedbackId,stage:"how",content:e.how[o].strategy}),l)return;c((o+1)%e.how.length)}}},children:[void 0!==e.why?(0,n.jsx)(r._S5,{size:14,className:"text-white"}):null,void 0!==e.how&&e.how.length>0&&!l?(0,n.jsx)(i.SCG,{size:16,className:"text-white"}):null,void 0!==e.how&&e.how.length>0&&l?(0,n.jsx)(i.T8D,{size:16,className:"text-white"}):null]}),l&&(0,n.jsxs)("p",{className:"absolute right-0 bottom-8 z-[10000] w-64 bg-white rounded-lg p-4 text-xs leading-5 shadow-lg flex gap-2 select-text border",children:[(0,n.jsx)("b",{className:"select-none",children:"Tip: "}),e.why,e.how&&e.how.length>0&&e.how[o].strategy]})]})};var c=t(1350);let h=e=>{let[l,t]=(0,a.useState)(""),r=(0,s.we)(e=>e.globalSentence),h=(0,s.B_)(e=>e.globalFeedback),g=(0,a.useMemo)(()=>{var l;return null===(l=e.feedbackId)||void 0===l?void 0:l.map(e=>h.find(l=>l.id===e))},[h]);(0,s.I9)(e=>e.globalHumanPlan);let f=(0,s.I9)(e=>e.getGlobalHumanPlanBySentenceId);(0,a.useEffect)(()=>{if(e.content){t(e.content);return}let l=f(r.id);if(void 0===l)return;let n=null==g?void 0:g.map(e=>l.reflection.find(l=>l.feedback===(null==e?void 0:e.content)))[0];"Why"===e.title?(null==n?void 0:n.why)?t(null==n?void 0:n.why):t(""):"How"===e.title&&((null==n?void 0:n.how)?t(null==n?void 0:n.how):t(""))},[r]);let x=(0,s.c)(e=>e.getGPTPlanByIdAndSentence);(0,a.useMemo)(()=>{var l;return void 0===e.feedbackId||void 0===r.content?[]:null===(l=e.feedbackId)||void 0===l?void 0:l.map(e=>void 0===r.content?null:x(e,r.content))},[e.feedbackId,r.content]);let m=(0,s.I9)(e=>e.addHowToGlobalHumanPlanBySentenceIdAndFeedback),u=(0,s.I9)(e=>e.addWhyToGlobalHumanPlanBySentenceIdAndFeedback);return(0,n.jsxs)("div",{className:"w-full border-l-8 rounded-lg flex flex-row gap-2 p-4 bg-white items-start",style:{borderColor:d.Cq[e.title]},children:[(0,n.jsxs)("div",{className:"flex flex-row gap-2 items-center text-sm py-2",children:["summary"===e.id?(0,n.jsx)(i.QcQ,{size:20}):"revision"===e.id?(0,n.jsx)(i.vPl,{size:20}):(0,n.jsx)(i.RxO,{size:20}),"What"===e.title?(0,n.jsx)("h1",{className:"font-semibold",children:"Sentence"}):"Why"===e.title?(0,n.jsx)("h1",{className:"font-semibold",children:"Problem"}):"How"===e.title?(0,n.jsx)("h1",{className:"font-semibold",children:"Solution"}):"Summary"===e.title?(0,n.jsx)("h1",{className:"font-semibold",children:"Summary"}):"Revision"===e.title?(0,n.jsx)("h1",{className:"font-semibold",children:"Revision"}):null]}),"what"===e.id?(0,n.jsx)("p",{className:"rounded-lg px-3 py-2 text-sm select-none",children:(0,n.jsx)(c.Z,{text:e.content||""})}):e.isNotModifiable?(0,n.jsx)("p",{className:"rounded-lg px-3 py-2 text-sm select-none",children:l}):(0,n.jsxs)("div",{className:"w-full flex flex-row justify-between items-center",children:[(0,n.jsx)("input",{type:"text",className:"rounded-lg border-0 text-sm w-full bg-gray-50 focus:ring-gray-400 mx-3",style:{borderWidth:2===e.planStage&&"Why"===e.title||3===e.planStage&&"How"===e.title?2:0,borderColor:2===e.planStage&&"Why"===e.title||3===e.planStage&&"How"===e.title?"skyblue":"gray"},value:l,onChange:e=>{t(e.target.value)},onBlur:()=>{var t,n;"Why"===e.title&&void 0!==e.feedbackId&&void 0!==g&&void 0!==r.id&&(null===(t=e.feedbackId)||void 0===t||t.forEach(e=>{var t;u(r.id,null===(t=g.find(l=>(null==l?void 0:l.id)===e))||void 0===t?void 0:t.content,l),(0,d.xT)({event:"change_plan",sentence:0===Object.keys(r).length?"all":r.id,feedback:e,stage:"why",content:l})})),"How"===e.title&&void 0!==e.feedbackId&&void 0!==g&&void 0!==r.id&&(null===(n=e.feedbackId)||void 0===n||n.forEach(t=>{var n;m(r.id,null===(n=g.find(e=>(null==e?void 0:e.id)===t))||void 0===n?void 0:n.content,l),(0,d.xT)({event:"change_plan",sentence:0===Object.keys(r).length?"all":r.id,feedback:e.feedbackId,stage:"how",content:l})}))}}),"why"===e.id?(0,n.jsx)(o,{why:'This sentence uses general adjectives like "very" and "many," but doesn\'t specify the extent of the positive impact or which specific aspects are affected.',feedbackId:e.feedbackId}):(0,n.jsx)(o,{how:[{title:"xxx",strategy:"Clarify 'many aspects of our lives' by identifying specific domains or areas where the positive impact of hi-tech devices is most felt."},{title:"xxx",strategy:"Provide concrete examples of how hi-tech devices positively impact different aspects of our lives, such as education, health, or communication."}],feedbackId:e.feedbackId})]})]})}}},function(e){e.O(0,[950,481,954,366,670,501,779,458,792,276,793,150,971,69,744],function(){return e(e.s=6051)}),_N_E=e.O()}]);